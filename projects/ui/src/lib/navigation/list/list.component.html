<ng-container *ngTemplateOutlet="switch; context: { children: items }"></ng-container>
<ng-template #switch let-children="children" let-level="level">
  <ng-container *ngFor="let item of children" [ngSwitch]="item.type">
    <ng-container *ngSwitchCase="'collapsible'">
      <ng-container *ngTemplateOutlet="collapsible; context: { item: item }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'header'">
      <ng-container *ngTemplateOutlet="header; context: { item: item }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchDefault>
      <ng-container *ngTemplateOutlet="action; context: { item: item }"></ng-container>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #action let-item="item">
  <ng-container [ngSwitch]="getComponentType(item)">
    <button *ngSwitchCase="'button'" type="button" matRipple class="ft-list__item" [ngClass]="item.class"
      (click)="setItem(item)">
      <ng-container *ngTemplateOutlet="text; context: { item: item }"></ng-container>
    </button>
    <a *ngSwitchCase="'link'" [routerLink]="item.url" routerLinkActive="ft-active" matRipple class="ft-list__item"
      [ngClass]="item.class" (click)="setItem(item)">
      <ng-container *ngTemplateOutlet="text; context: { item: item }"></ng-container>
    </a>
  </ng-container>
</ng-template>
<ng-template #collapsible let-item="item">
  <button type="button" matRipple class="ft-collapsible-header ft-list__item"
    [ngClass]="{ 'ft-show': item.metadata?.show }" (click)="toggleCollapsible(item)">
    <div class="ft-item">
      <ft-icon class="ft-item__icon" *ngIf="item[iconNameField]" [name]="item[iconNameField]"
        [collection]="iconCollection" [path]="iconPath"></ft-icon>
      <div class="ft-item__label">{{ item[labelField] }}</div>
      <ft-icon class="ft-item__toggle" name="angle-right" size="1"></ft-icon>
    </div>
  </button>
  <div class="ft-collapsible" [ngClass]="{ 'ft-show': item.metadata?.show }" *ngIf="item.children">
    <ng-container *ngTemplateOutlet="switch; context: { children: item.children }"></ng-container>
  </div>
</ng-template>
<ng-template #header let-item="item">
  <div class="ft-header" [ngClass]="item.class">
    {{ item[labelField] }}
  </div>
</ng-template>
<ng-template #text let-item="item">
  <div class="ft-item">
    <ft-icon class="ft-item__icon" *ngIf="item[iconNameField]" [name]="item[iconNameField]" [collection]="iconCollection"
      [path]="iconPath"></ft-icon>
    <div class="ft-item__label">{{ item[labelField] }}</div>
  </div>
</ng-template>