<ng-container *ngTemplateOutlet="switchTemplate; context: { children: items }"></ng-container>
<ng-template #switchTemplate let-children="children" let-level="level">
  <ng-container *ngFor="let action of children; trackBy: trackById" [ngSwitch]="action.type">
    <ng-container *ngSwitchCase="'collapsible'">
      <ng-container *ngTemplateOutlet="collapsibleTemplate; context: { action: action }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'header'">
      <ng-container *ngTemplateOutlet="headerTemplate; context: { action: action }"></ng-container>
    </ng-container>
    <ng-container *ngSwitchDefault>
      <ng-container *ngTemplateOutlet="actionTemplate; context: { action: updateAction(action) }"></ng-container>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #actionTemplate let-action="action">
  <ng-container [ngSwitch]="action.metadata.componentType">
    <button *ngSwitchCase="'button'" type="button" class="ft-button ft-list__item"
      [ngClass]="[action.class || '', selectable && selection.indexOf(action) !== -1 ? 'ft-list__item--selected' : '']"
      (click)="handleClick(action)" [disabled]="action.disabled">
      <ng-container *ngTemplateOutlet="itemTemplate || textTemplate; context: { action: action }"></ng-container>
    </button>
    <a *ngSwitchCase="'link'" [routerLink]="action.url" [queryParams]="action.metadata?.queryParams"
      routerLinkActive="ft-list__item--active" class="ft-button ft-list__item"
      [ngClass]="[action.class || '', selectable && selection.indexOf(action) !== -1 ? 'ft-list__item--selected' : '']"
      (click)="handleClick(action)">
      <ng-container *ngTemplateOutlet="itemTemplate || textTemplate; context: { action: action }"></ng-container>
    </a>
  </ng-container>
</ng-template>
<ng-template #collapsibleTemplate let-action="action">
  <ft-collapsible [header]="action[labelField]" [expanded]="action.metadata?.show">
    <div class="ft-list">
      <ng-container *ngTemplateOutlet="switchTemplate; context: { children: action.children }"></ng-container>
    </div>
  </ft-collapsible>
</ng-template>
<ng-template #headerTemplate let-action="action">
  <div class="ft-list__header" [ngClass]="action.class">
    {{ action[labelField] }}
  </div>
</ng-template>
<ng-template #textTemplate let-action="action">
  <div class="ft-item">
    <ft-icon class="ft-item__icon" *ngIf="action[iconNameField] || (selectable && selection.indexOf(action) !== -1)"
      [name]="action[iconNameField]" [collection]="iconCollection" [path]="iconPath"></ft-icon>
    <div class="ft-item__label">{{ action[labelField] }}</div>
  </div>
</ng-template>